# DeMoim_Backend

 <h1 align="center" style="color:mediumpurple"> Demoim  </h1>

## [â–¶ï¸ ìœ íŠœë¸Œ ë§í¬](https://www.youtube.com/watch?v=fzInCo4VSLE)

## [ğŸ„½ Notion ë§í¬](https://hollow-slipper-e81.notion.site/DeMoim_Public-2412eac814614a45927deb0ab963c072)

<br/>
<br/>

## ğŸ–¥ í”„ë¡œì íŠ¸ ì†Œê°œ

ì·¨ì—…ê³¼ ì»¤ë¦¬ì–´ì¤€ë¹„ ë“± ì§ì—…ì  ê³µë°±ê¸°ì— ìˆëŠ” ì‚¬ëŒë“¤ì—ê²Œ <br>
ê°ìì˜ ì•„ì´ë””ì–´ë¥¼ í™œìš©í•˜ì—¬ íŒ€ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ ì§„í–‰í•´ë‚˜ê°ˆ ìˆ˜ ìˆëŠ” ì†Œì…œ ì»¤ë®¤ë‹ˆí‹° ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

<br/>

## ğŸ” ìš”ì•½

ì˜ˆë¹„ê°œë°œì/ë””ìì´ë„ˆ/ê¸°íšì ë“¤ì´ ì§ì ‘ í”„ë¡œì íŠ¸ íŒ€ì„ ëª¨ì§‘í•˜ê³  ì§€ì› í•  ìˆ˜ ìˆëŠ” íŒ€ë¹Œë”© í”Œë«í¼

- í”„ë¡œì íŠ¸ ëª¨ì§‘ê³µê³ ë¥¼ ì‘ì„±í•˜ê³ , ì§€ì›ìë¥¼ ì„ íƒí•˜ì—¬ í”„ë¡œì íŠ¸ íŒ€ êµ¬ì„±
- íšŒì› ê°„ í”„ë¡œí•„ ì—´ëŒì„ í†µí•´ ìƒí˜¸ê°„ ê¸°ë³¸ì ì¸ ì •ë³´ ì œê³µ(í¬ì§€ì…˜,ì—°ë½ì²˜,ê°„ë‹¨í•œ ì†Œê°œ)
- ë³¸ì¸ì´ ë½ë‚´ê³  ì‹¶ì€ í”„ë¡œì íŠ¸ë“¤ì„ ê³µìœ í•  ìˆ˜ ìˆê³ , íšŒì› ê°„ ìŠ¤ëª°í†¡ì„ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ” ì»¤ë®¤ë‹ˆí‹°

<br/>

## ğŸ“† ê¸°ê°„

2021ë…„ 4ì›” 23ì¼ ~ 2021ë…„ 5ì›” 28ì¼

<br/>

## ğŸ—£ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ íˆ´

Github, Slack, Gather

## ğŸ¤  íŒ€ì›ì†Œê°œ ([Notion](https://www.notion.so/Demoim-87856b49c18545358ee657b434bff365))

<br/>

ì´ 6ëª…

- ë°±ì—”ë“œ
  - ì •ì„ì§„(Spring, React)
  - ì´ì€ì§€(Spring)
  - ê¹€ì¤€ì—½(Spring)
- í”„ë¡ íŠ¸ì—”ë“œ ([FrontEnd Github](https://github.com/holasim91/demoim_fe))
  - ì‹¬í˜„ì¸(React)
  - ê³ ì •ì›(React)
- UX/UI ë””ìì´ë„ˆ ([Zeplin](https://app.zeplin.io/project/608a507a3f3d51355497c44c))
  - ê¹€ë¯¼ê²½

## ğŸš€ ê¸°ëŠ¥

### [íšŒì›ê°€ì…/ë¡œê·¸ì¸ í˜ì´ì§€] MySQL

- íšŒì›ê°€ì… ë° ë¡œê·¸ì¸ ê¸°ëŠ¥ \_ Spring Security, JWT Authentication, MySQL, Spring Data JPA
  - Cool SMS API(ë¬¸ìë°œì†¡ API)

### [ë©”ì¸ í˜ì´ì§€(íŒ€ë©”ì´í‚¹, Detalk)]

- íŒ€ë©”ì´í‚¹(í”„ë¡œì íŠ¸ ëª¨ì§‘) \_ MySQL, Spring Data JPA

  ```
  ì£¼ìµœìì˜ ê²½ìš°
  Quill-Editorë¥¼ ì‚¬ìš©í•´ì„œ ì‘ì„±ìê°€ ì›í•˜ëŠ” ëª¨ì§‘ê¸€ì„ ì“¸ ìˆ˜ ìˆë‹¤.
  í”„ë¡ íŠ¸ì—”ë“œ / ë°±ì—”ë“œ / ë””ìì´ë„ˆ / ê¸°íšìë¥¼ ëª¨ì§‘í•  ìˆ˜ ìˆê³ , ìµœëŒ€ ì¸ì›ì€ ì´ 10ëª…ì´ë‹¤.
  ì›í•˜ëŠ” ê¸°ê°„ë§Œí¼ ëª¨ì§‘ì„ í•  ìˆ˜ ìˆìœ¼ë©°, ì§€ì›ìë¥¼ ì„ íƒí•˜ì—¬ íŒ€ì›ìœ¼ë¡œ ë½‘ì„ ìˆ˜ ìˆë‹¤.
  ì£¼ìµœìê°€ í¬ë§ì¸ì›ì„ ë‹¤ ì„ íƒì„ í•˜ê±°ë‚˜ ëª¨ì§‘ ê¸°ê°„ì´ ì§€ë‚˜ë©´ ëª¨ì§‘ì´ ë§ˆê°ëœë‹¤

  ì°¸ê°€ìì˜ ê²½ìš°
  ì›í•˜ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§€ì› í•  ìˆ˜ ìˆë‹¤.
  ```

- Detalk
  - Exhibition(í”„ë¡œì íŠ¸ ìë‘í•˜ê¸°) \_ MySQL, Spring Data JPA
    ```
    Quill-Editorì„ ì´ìš©í•˜ì—¬ ì‚¬ìš©ìê°€ ìì‹ ì´ í–ˆë˜ í”„ë¡œì íŠ¸ë¥¼ ë‹¤ë¥¸ íšŒì›ë“¤ê³¼ ê³µìœ í•  ìˆ˜ ìˆë‹¤.
    ëŒ“ê¸€ë¡œ í•´ë‹¹ í”„ë¡œì íŠ¸ì— ëŒ€í•œ í”¼ë“œë°±ì„ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆë‹¤.
    ```
  - Smalltalk(ìŠ¤ëª°í†¡ í”¼ë“œ) \_ MySQL, Spring Data JPA
    ```
    ì†Œì†Œí•œ ì¡ë‹´ë° ì •ë³´ë¥¼ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ” ê³µê°„ì´ë‹¤.
    ëŒ“ê¸€ë¡œ ì§ˆë¬¸ì„ ì£¼ê³  ë°›ì„ ìˆ˜ ìˆë‹¤.
    ```

### [ë‚˜ì˜ ë¡œê·¸]

- ë¡œê·¸ì¸ íšŒì›ì˜ í”„ë¡œí•„ ê´€ë¦¬(MySQL, Spring Data JPA, Storage - AWS S3)
- ë‚˜ì˜ í”„ë¡œì íŠ¸ ì°¸ê°€ ì´ë ¥ê³¼, í˜„ì¬ ì°¸ê°€ í•˜ê³  ìˆëŠ” í”„ë¡œì íŠ¸, ë‚´ê°€ ì£¼ìµœí•œ í”„ë¡œì íŠ¸ í™•ì¸
- ìì‹ ì´ ì°¸ì—¬ì¤‘ì¸ í”„ë¡œì íŠ¸ì˜ ë‹¤ë¥¸ ìœ ì €ì˜ ì •ë³´ í™•ì¸
- ìì‹ ì´ ì‘ì„±í•œ ìŠ¤ëª°í†¡ê³¼ í”„ë¡œì íŠ¸ ìë‘í•˜ê¸° í”¼ë“œ

## ğŸ¦„ í”„ë¡œì íŠ¸ ì¸ë„¤ì¼

![image](https://user-images.githubusercontent.com/78028746/121785601-a7593700-cbf5-11eb-8406-009f18524c06.png)

## ğŸ”– ê¸°ìˆ ìŠ¤íƒ

#### ë°±ì—”ë“œ í˜‘ì—… íˆ´

- Host Server: ubuntu18.04 - t2.micro(AWS EC2)
- File Storage: AWS S3 Bucket
- Database: MySQL 8.0.20(AWS RDS)

- Framework : SpringBoot 2.4.5
- Java: JDK 1.8.0
- IDE: IntelliJ IDEA 2021.1.1 x64
- Build Management: Gradle
- ORM: Spring Data JPA
- Sub-Framework: Spring Security, SpringBoot Websocket

- View Template Engine: React.js(í”„ë¡ íŠ¸ì—”ë“œ)

### ğŸ‘‘ After í”„ë¡œì íŠ¸

- ì›¹ì‚¬ì´íŠ¸ ë³´ì•ˆ ê°•í™”
  - SSL í™œìš©í•œ HTTPS ë³€ê²½
- ì‹¤ì‹œê°„ ì•Œë¦¼ ë° ì±„íŒ… ì„œë¹„ìŠ¤
  - Redis Pub/Sub í™œìš©í•œ WebSocket í†µì‹  ë˜ëŠ” ì™¸ë¶€ API(ì±„ë„í†¡) ë„ì… ê²€í† 
- ì†Œì…œë¡œê·¸ì¸
  - ì¹´ì¹´ì˜¤, ë„¤ì´ë²„ ì†Œì…œë¡œê·¸ì¸(OAuth2)\

<br>

## í…Œì´ë¸” ì„¤ê³„

![image](https://user-images.githubusercontent.com/78028746/119464301-8da69b80-bd7d-11eb-9f0e-b94edf8f95c2.png)

<br>
<br>

## ì£¼ìš” ê¸°ëŠ¥ ì†Œê°œ

<br>

### ì—”í‹°í‹° ì„¤ê³„ì‹œ ì–‘ë°©í–¥ ë§¤í•‘

- í…Œì´ë¸”ê³¼ íŒ¨ëŸ¬ë‹¤ì„ì˜ ë¶ˆì¼ì¹˜ë¥¼ í•´ì†Œí•˜ê¸°ìœ„í•´ì„œ ê°ì²´ê°€ ì„œë¡œë¥¼ ì°¸ì¡° í•  ìˆ˜ìˆë„ë¡ ì–‘ë°©í–¥ .
- LAZY íƒ€ì…ì„ í†µí•´ ë¶ˆí•„ìš”í•˜ê²Œ ì°¸ì¡°ë˜ëŠ” ë°ì´í„° ì¡°íšŒë¥¼ í•´ê²° -> ì„±ëŠ¥ ì´ìŠˆë¥¼ ë°©ì§€

```java
 @ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "userId")
private User smallTalkUser;

@Builder
public SmallTalk(String contents) {
        this.contents = contents;
        }

public void setUser(User user){

        //ê¸°ì¡´ì— ìˆë˜ smallTalkì„ ì œê±°
        if(this.smallTalkUser != null){
        this.smallTalkUser.getSmallTalks().remove(this);
        }
        this.smallTalkUser = user;
        smallTalkUser.getSmallTalks().add(this);
        }
```

<br>

### S3ë¥¼ ì´ìš©í•œ ì´ë¯¸ì§€ ì—…ë¡œë“œ

```java
// Service ë‹¨ ì½”ë“œ ë°œì·Œ
import com.amazonaws.services.s3.model.ObjectMetadata;

@RequiredArgsConstructor
@Service
public class FileUploadService {

  private final S3Service s3Service;

  public String uploadImage(MultipartFile file) {
    String fileName = createFileName(file.getOriginalFilename());

    ObjectMetadata objectMetadata = new ObjectMetadata();
    objectMetadata.setContentType(file.getContentType());

    try (InputStream inputStream = file.getInputStream()) {
      s3Service.uploadFile(inputStream, objectMetadata, fileName);
    } catch (IOException e) {
      throw new IllegalArgumentException(String.format("íŒŒì¼ ë³€í™˜ ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤ (%s)", file.getOriginalFilename()));
    }
    return s3Service.getFileUrl(fileName);
  }

  private String createFileName(String originalFileName) {
    return UUID.randomUUID().toString().concat(getFileExtension(originalFileName));
  }

  private String getFileExtension(String fileName) {
    try {
      return fileName.substring(fileName.lastIndexOf("."));
    } catch (StringIndexOutOfBoundsException e) {
      throw new IllegalArgumentException(String.format("ì˜ëª»ëœ í˜•ì‹ì˜ íŒŒì¼ (%s) ì…ë‹ˆë‹¤", fileName));
    }
  }
}
```

- import com.amazonaws.services.s3.model.ObjectMetadata; / aws s3 ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„í¬íŠ¸

<br>

<br>
<br>

## ìµœì¢… ì„±ê³¼

- ì‘ì€ ìˆ«ìë¼ê³  í• ìˆ˜ìˆì§€ë§Œ ì‹¤ì œë¡œ ì‚¬ìš©ìë¥¼ ëŸ°ì¹­í•˜ê³  í”¼ë“œë°±ì„ ë°›ì•„ë³´ëŠ” ëª©í‘œë¥¼ ì‹¤ì œë¡œ ì´ë£¨ì›Œë‚¸ ê²½í—˜ì…ë‹ˆë‹¤. ì œê°€ ê°œë°œí•œ ì‚¬ì´íŠ¸ë¥¼ ì‹¤ì œë¡œ ì‚¬ìš©í•´ì£¼ì‹œëŠ” ë¶„ë“¤ì´ ìˆë‹¤ëŠ” ì ì—ì„œ ë¿Œë“¯í•¨ì„ ëŠê¼ˆë˜ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

![image](https://user-images.githubusercontent.com/78028746/121785420-ab388980-cbf4-11eb-98e8-0a2f4935797c.png)

![image](https://user-images.githubusercontent.com/78028746/121783238-6dcdff00-cbe8-11eb-9f34-2abfa34a9e0b.png)

<br>
<br>

## ì‹¤ì œ ì‚¬ì´íŠ¸ì— ì˜¬ë¼ì˜¨ ì‚¬ìš©ì ê²Œì‹œê¸€

![image](https://user-images.githubusercontent.com/78028746/121785373-74fb0a00-cbf4-11eb-8e79-d7c237ac3171.png)
![image](https://user-images.githubusercontent.com/78028746/121785380-7cbaae80-cbf4-11eb-91d6-7f59deadca97.png)
![image](https://user-images.githubusercontent.com/78028746/121785386-83e1bc80-cbf4-11eb-8999-614cba71e9cb.png)
![image](https://user-images.githubusercontent.com/78028746/121785393-87754380-cbf4-11eb-95f0-ade27b7436a5.png)
